import{_ as B}from"./DW4Dnba0.js";import{a as Z,d as E,y as $,r as S,J as I,z as V,c as m,e as p,f as e,g as a,w as d,aa as C,D as f,X as v,h as t,R as ee,k as U,l as P,B as M,t as T,m as se,n as F,j as te,H as ne,v as O,x as j,_ as R,b as oe,u as ie,o as ae,C as z,V as le}from"./Bn8s6ksr.js";import ce from"./CIirbjzG.js";import{b as H,a as L,u as G,l as de,s as re,c as ue}from"./7jZtv5KM.js";import _e from"./D93hn2hz.js";import{u as me}from"./DOgkogYK.js";import"./DvLZ7Zqz.js";import"./Beh2qRuB.js";import"./CVaRbyVJ.js";import"./BXRJdK4x.js";import"./B2cK24SD.js";import"./BLi23Xor.js";import"./CGQTC3f5.js";const D=()=>H("mobile",()=>!1),J=()=>H("menuActive",()=>!1),A=async(i=null)=>{let s=D();return console.log("Force mobile",i),i!==null?s.value=i:s.value=!s.value,s},k=async(i=null)=>{let s=J();return console.log("Force menu",i),i!==null?s.value=i:s.value=!s.value,s},W="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3c!--%20Generator:%20Adobe%20Illustrator%2026.4.1,%20SVG%20Export%20Plug-In%20.%20SVG%20Version:%206.00%20Build%200)%20--%3e%3csvg%20version='1.1'%20id='b'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20x='0px'%20y='0px'%20viewBox='0%200%2070%2070'%20style='enable-background:new%200%200%2070%2070;'%20xml:space='preserve'%3e%3cstyle%20type='text/css'%3e%20.st0{fill:%231E42BB;}%20.st1{enable-background:new%20;}%20.st2{fill:%23FFFFFF;}%20%3c/style%3e%3cg%20id='c'%3e%3cg%3e%3crect%20class='st0'%20width='70'%20height='70'/%3e%3cg%20class='st1'%3e%3cpath%20class='st2'%20d='M4,48.5v-27h17.3v4.2H8.9v6.7h11v4.1h-11v7.9h13.3v4.2H4z'/%3e%3cpath%20class='st2'%20d='M45.6,21.5v4.2h-8.3v22.7h-4.9V25.8h-8.3v-4.2H45.6z'/%3e%3cpath%20class='st2'%20d='M55.9,44.8c1.8,0,3-0.3,3.9-0.9c0.8-0.6,1.2-1.4,1.2-2.5c0-0.6-0.1-1.2-0.4-1.7s-0.7-0.9-1.2-1.3%20c-0.5-0.4-1.1-0.7-1.8-1.1c-0.7-0.3-1.6-0.6-2.5-1c-0.9-0.3-1.8-0.7-2.7-1.1c-0.9-0.4-1.6-0.9-2.3-1.5c-0.7-0.6-1.2-1.3-1.6-2.1%20c-0.4-0.8-0.6-1.8-0.6-3c0-2.4,0.8-4.4,2.5-5.7c1.7-1.4,4-2.1,6.9-2.1c1.7,0,3.2,0.2,4.5,0.6c1.3,0.4,2.3,0.8,3.1,1.2l-1.5,4%20c-0.9-0.5-1.8-0.9-2.9-1.1c-1.1-0.3-2.1-0.4-3.2-0.4c-1.3,0-2.4,0.3-3.1,0.8c-0.7,0.5-1.1,1.3-1.1,2.3c0,0.6,0.1,1.1,0.4,1.5%20s0.6,0.8,1.1,1.1c0.5,0.3,1,0.6,1.6,0.9c0.6,0.3,1.3,0.6,2,0.8c1.3,0.5,2.4,0.9,3.4,1.4c1,0.5,1.8,1.1,2.5,1.7%20c0.7,0.7,1.2,1.4,1.6,2.3c0.4,0.9,0.5,2,0.5,3.2c0,2.4-0.9,4.3-2.6,5.7c-1.7,1.3-4.2,2-7.6,2c-1.1,0-2.1-0.1-3.1-0.2%20c-0.9-0.1-1.7-0.3-2.5-0.5c-0.7-0.2-1.3-0.4-1.8-0.6c-0.5-0.2-0.9-0.4-1.2-0.6l1.4-4c0.7,0.4,1.6,0.8,2.8,1.2%20C52.7,44.7,54.2,44.8,55.9,44.8z'/%3e%3c/g%3e%3c/g%3e%3c/g%3e%3c/svg%3e",pe=Z(),fe=async i=>{try{const s=await fetch(`${pe.public.apiNotification}/notifications/mark-read`,{method:"PUT",body:JSON.stringify({notificationIds:i})});if(!s.ok)throw new Error("Failed to read notifications");return L(!0),await s.json()}catch(s){throw console.error("Error reading notifications:",s),s}},h=i=>(O("data-v-caa52bf5"),i=i(),j(),i),ve={class:"navigation"},he=h(()=>e("img",{src:W,alt:"logo",style:{"user-select":"none","z-index":"1"},class:"logo-img"},null,-1)),ge={class:"header-logo-text"},ke=h(()=>e("span",{class:"name"},"EduTech",-1)),we=h(()=>e("span",{class:"profession"},"Solution",-1)),ye=[ke,we],Ce=h(()=>e("div",{class:"icon-arrow"},null,-1)),xe=[Ce],be={class:"navigation-main"},Se=h(()=>e("div",{class:"icon-home"},null,-1)),$e={class:"text-nav"},Me={class:"navigation-other"},Ne={class:"nav-link"},Ee=h(()=>e("div",{class:"icon-profile"},null,-1)),Re={class:"text-nav"},De={class:"relative"},Ie=h(()=>e("i",{class:"pi pi-bell",style:{"font-size":"1.55rem"}},null,-1)),Ue={class:"text-nav"},Pe=h(()=>e("div",{class:"icon-logout"},null,-1)),Te={class:"text-nav"},Fe={class:"flex flex-col gap-3 w-25rem"},ze={class:"flex justify-between items-center align-center"},Ae=h(()=>e("span",{class:"font-medium text-900 block"},"Уведомления",-1)),Be={key:0},Ve={class:"notifications-list"},Oe={class:"flex justify-between items-center align-center"},je={class:"notification-content"},He={key:0,class:"notification-dot"},Le={key:1},Ge=E({__name:"TheNavbar",async setup(i){let s,r;const w=([s,r]=$(()=>G()),s=await s,r(),s).value,u=D(),x=S([]),l=S(!1),g=S(),y=([s,r]=$(()=>L()),s=await s,r(),s).value,b=I(()=>y.pending?0:y.notificationData.data.filter(o=>!o.is_read).length);V(()=>{if(!w.pending){const o=w.userData.permissions.map(_=>_.code),n=[{id:1,name:"Read Courses",permissions:["READ_COURSES"],title:"Курсы",link:"/course",icon:"book"},{id:4,name:"Tests assign",permissions:["CRUD_USERS"],title:"Тестирование",link:"/tests/assign",icon:"tests"},{id:5,name:"Admin Panel",permissions:["CRUD_USERS","CRUD_ROLES","CRUD_GROUPS","CREATE_COURSES","UPDATE_COURSES"],title:"Администрирование",link:"/admin",icon:"admin_panel"}];x.value=n.filter(_=>_.permissions.some(N=>o.includes(N)))}});const X=I(()=>x.value),q=o=>{g.value.toggle(o)},K=()=>{g.value.hide();const o=y.notificationData.data.filter(n=>!n.is_read).map(n=>n.id);o.length>0&&fe(o)};return(o,n)=>{const _=B,N=ne,Q=ce;return m(),p("nav",ve,[e("header",null,[a(_,{to:"/home",style:{display:"flex",gap:"10px","align-content":"center"},onClick:n[0]||(n[0]=c=>t(u)&&("handleMenu"in o?o.handleMenu:t(k))(!1))},{default:d(()=>[he,a(C,{name:"slide"},{default:d(()=>[f(e("div",ge,ye,512),[[v,t(l)]])]),_:1})]),_:1}),e("div",{class:"menu-open",style:ee(t(l)?"transform: rotate(-270deg)":""),onClick:n[1]||(n[1]=c=>l.value=!t(l))},xe,4)]),e("ul",be,[e("li",{class:"nav-link",onClick:n[3]||(n[3]=()=>{})},[a(_,{to:"/home",onClick:n[2]||(n[2]=c=>t(u)&&("handleMenu"in o?o.handleMenu:t(k))(!1))},{default:d(()=>[Se,a(C,{name:"slide"},{default:d(()=>[f(e("span",$e,"Главная",512),[[v,t(l)]])]),_:1})]),_:1})]),(m(!0),p(U,null,P(t(X),c=>(m(),p("li",{key:c.id,class:"nav-link"},[a(_,{to:c.link,onClick:n[4]||(n[4]=Y=>t(u)&&("handleMenu"in o?o.handleMenu:t(k))(!1))},{default:d(()=>[e("div",{class:M(`icon-${c.icon}`)},null,2),a(C,{name:"slide"},{default:d(()=>[f(e("span",{class:"text-nav"},T(c.title),513),[[v,t(l)]])]),_:2},1024)]),_:2},1032,["to"])]))),128))]),e("ul",Me,[e("li",Ne,[a(_,{to:"/profile",onClick:n[5]||(n[5]=c=>t(u)&&("handleMenu"in o?o.handleMenu:t(k))(!1))},{default:d(()=>[Ee,a(C,{name:"slide"},{default:d(()=>[f(e("span",Re,"Профиль",512),[[v,t(l)]])]),_:1})]),_:1})]),e("li",{class:"nav-link flex justify-center notification",onClick:q},[a(_,{onClick:n[6]||(n[6]=c=>t(u)&&("handleMenu"in o?o.handleMenu:t(k))(!1))},{default:d(()=>[e("div",De,[Ie,t(b)>0?(m(),se(N,{key:0,value:t(b),class:"badge"},null,8,["value"])):F("",!0)]),a(C,{name:"slide"},{default:d(()=>[f(e("span",Ue,"Уведомления",512),[[v,t(l)]])]),_:1})]),_:1})]),e("li",{class:"nav-link",onClick:n[8]||(n[8]=c=>("logout"in o?o.logout:t(de))())},[a(_,{onClick:n[7]||(n[7]=c=>t(u)&&("handleMenu"in o?o.handleMenu:t(k))(!1))},{default:d(()=>[Pe,a(C,{name:"slide"},{default:d(()=>[f(e("span",Te,"Выйти",512),[[v,t(l)]])]),_:1})]),_:1})])]),a(Q,{ref_key:"notificationPanel",ref:g,class:"min-w-[300px] w-[25rem]",onHide:K},{default:d(()=>[e("div",Fe,[e("div",ze,[Ae,a(_,{to:"/notifications",class:"text-blue-500"},{default:d(()=>[te("Все")]),_:1})]),t(y).notificationData.data.length>0?(m(),p("div",Be,[e("ul",Ve,[(m(!0),p(U,null,P(t(y).notificationData.data.slice(0,10),(c,Y)=>(m(),p("li",{key:c.id,class:M({unread:!c.is_read})},[e("div",Oe,[e("div",je,T(c.message),1),c.is_read?F("",!0):(m(),p("div",He))])],2))),128))])])):(m(),p("div",Le," Нет уведомлений "))])]),_:1},512)])}}}),Je=R(Ge,[["__scopeId","data-v-caa52bf5"]]),We=i=>(O("data-v-72d03926"),i=i(),j(),i),Xe={class:"header-aside"},qe=We(()=>e("img",{src:W,alt:"logo",style:{width:"40px"}},null,-1)),Ke=E({__name:"TheNavigation",setup(i){oe(),ie("token");const s=D(),r=J(),w=S(0);function u(){if(w.value=window.innerWidth,w.value<=920){A(!0);return}A(!1),r.value=!1}return ae(()=>{window.addEventListener("resize",u),u()}),(x,l)=>{const g=Je,y=B;return m(),p("aside",{class:M(t(s)?"menu-horizontal":"menu-vertical")},[f(a(g,null,null,512),[[v,!t(s)]]),f(e("div",Xe,[a(y,{to:"/home",style:{display:"flex","justify-content":"center","align-items":"center"}},{default:d(()=>[qe]),_:1}),e("div",{class:M(["icon-menu",{"icon-active":t(r)}]),onClick:l[0]||(l[0]=b=>t(k)())},null,2)],512),[[v,t(s)]]),a(C,{name:"mobile-nav"},{default:d(()=>[f(e("div",{class:"full-screen",onClick:l[2]||(l[2]=z(b=>t(k)(!1),["stop"]))},[e("nav",{class:"navigation-dropdown",onClick:l[1]||(l[1]=z(()=>{},["stop"]))},[a(g)])],512),[[v,t(r)]])]),_:1})],2)}}}),Qe=R(Ke,[["__scopeId","data-v-72d03926"]]),Ye={class:"wrapper"},Ze={class:"page"},es={class:"main"},ss=E({__name:"home",async setup(i){let s,r;const w=([s,r]=$(()=>G()),s=await s,r(),s).value;return[s,r]=$(()=>me(!0)),await s,r(),V(()=>{w.pending||ue()||re()}),(u,x)=>{const l=Qe,g=_e;return m(),p("div",Ye,[e("div",Ze,[a(l),e("div",es,[a(g),le(u.$slots,"default",{},void 0,!0)])])])}}}),fs=R(ss,[["__scopeId","data-v-34dd0e68"]]);export{fs as default};
